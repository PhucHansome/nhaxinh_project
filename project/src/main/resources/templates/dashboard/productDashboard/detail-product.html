<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Dashboard | Uplon - Responsive Bootstrap 4 Admin Dashboard</title>
    <th:block th:replace="/dashboard/layout/header::header"/>
</head>

<body>

<!-- Begin page -->
<div id="wrapper">


    <!-- Topbar Start -->
    <th:block th:replace="/dashboard/layout/navbar/navbar::navbar"/>
    <!-- end Topbar -->


    <!-- ========== Left Sidebar Start ========== -->
    <th:block th:replace="/dashboard/layout/left-side-menu::left-side-menu"/>
    <!-- Left Sidebar End -->

    <!-- ============================================================== -->
    <!-- Start Page Content here -->
    <!-- ============================================================== -->

    <div class="content-page">
        <div class="content">
            <div class="container-fluid">

                <div class="row shadow-lg p-2 mb-5 bg-body rounded" style="margin-top: 10px">
                    <div class="col-md-5">
                        <h6><a href="/product-dashboard">Quay lại danh sách sản phẩm</a></h6>
                    </div>
                    <div class="col-md-7">
                        <button type="button" style="margin-bottom: 10px"
                                class="btn btn-primary float-right ">
                            <i class="fas fa-edit"></i>
                            Sửa sản phẩm
                        </button>
                        <button type="button" style="margin-bottom: 10px;margin-right: 10px;"
                                class="btn btn-danger float-right btn-delete ">
                            <i class="fas fa-trash"></i>
                            Xoá
                        </button>

                    </div>
                </div>
                <div class="row" style="top: -25px; position: relative;">
                    <div class="col-md-12">
                        <h3>THÔNG TIN SẢN PHẨM</h3>
                    </div>
                </div>
                <th:block th:each="product, count : ${product}">
                    <div class="row shadow-lg p-3 mb-5 bg-body rounded">
                        <div class="col-md-12" style="padding-bottom: 40px;left: 40px;padding-top: 15px;">
                            <h4 th:text="*{product.title}"></h4>
                        </div>

                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-12 text-center align-middle"><img th:width="330px"
                                                                                  th:src="*{product.image}" alt="">
                                </div>
                            </div>

                            <div class="row" style="top: 30px;position: relative;">
                                <th:block th:each="productMedia, count : ${productMedia}">
                                    <div class="col-3 text-center align-middle">
                                        <img th:width="100px" style="padding-top: 15px;"  th:src="${productMedia.fileUrl}" alt="">
                                    </div>
                                </th:block>
                            </div>
                        </div>
                        <div class="col-md-8" style="left: 20px;border-left: 2px solid #0000003b;padding-left: 50px;">
                            <div class="row">
                                <div class="col-md-6">
                                    <label>Mã SKU:</label>
                                    <p th:text="*{product.code}"></p>
                                </div>
                                <div class="col-md-6">
                                    <label>Loại sản phẩm:</label>
                                    <p th:text="*{product.category.name}"></p>

                                </div>
                                <div class="col-md-6">
                                    <label>Số lượng:</label>
                                    <p th:text="*{product.quantity}"></p>

                                </div>
                                <div class="col-md-6">
                                    <label>Giá sản phẩm:</label>
                                    <p style="color: red;font-weight: bold;" th:text="*{#numbers.formatCurrency(product.price)}"></p>
                                </div>
                                <div class="col-md-6">
                                    <label>Kích thước:</label>
                                    <p th:text="*{product.size}"></p>

                                </div>
                                <div class="col-md-6">
                                    <label>Màu sắc:</label>
                                    <p th:text="*{product.productColor.color}"></p>

                                </div>
                                <div class="col-md-6">
                                    <label>Chất liệu:</label>
                                    <p th:text="*{product.material}"></p>

                                </div>
                                <div class="col-md-6">
                                    <label>Trạng thái:</label>
                                    <p th:text="*{product.status}"></p>

                                </div>
                                <th:block th:each="tag, count : ${tag}">
                                    <div class="col-md-6">
                                        <label>Tag:</label>
                                        <p th:text="*{tag.name}"></p>

                                    </div>
                                </th:block>
                                <div class="col-md-6">
                                </div>
                                <div class="col-md-12">
                                    <label>Description:</label>
                                    <p th:utext="*{product.description}"></p>
                                </div>

                            </div>

                        </div>

                    </div>
                    <div class="row" style="top: -25px; position: relative;">
                    </div>
                    <input type="hidden" id="idProduct" th:field="*{product.id}" >
                </th:block>
                <div class="col-md-12">

                </div>

            </div>

        </div>
        <!-- Start Content-->

    </div> <!-- end content -->


    <!-- Footer Start -->
    <th:block th:replace="/dashboard/layout/footer::footer"/>
    <!-- end Footer -->

</div>

<!-- ============================================================== -->
<!-- End Page content -->
<!-- ============================================================== -->

</div>
<!-- END wrapper -->

<!-- Right Sidebar -->

<!-- Vendor js -->
<th:block th:replace="/dashboard/layout/script/script::script"/>
</body>
<script>
    let page = {
        url: {
            GetProduct: App.BASE_URL_PRODUCT,
            DeleteProduct : App.BASE_URL_PRODUCT + "/delete-soft-product/"
        },
        element: {},
        loadData: {},
        commands: {},
        dialogs: {
            element: {},
            loadData: {},
            commands: {},
            close: {},
            alertDanger: {},
            inputError: {}
        }
    }

    page.element.idProduct = $("#idProduct")

    page.element.btnDelete = $(".btn-delete")

    page.commands.handleDeleteProduct = () =>{
        page.element.btnDelete.on("click", function(){
            Swal.fire({
                title: 'Bạn có muốn xóa sản phẩm  này không?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Đúng, Xóa nó!'
            }).then((resuilt)=>{
                if (resuilt.isConfirmed){
                    $.ajax({
                        type: "DELETE",
                        url: page.url.DeleteProduct + page.element.idProduct.val() ,
                    }).done(()=>{
                        App.SweetAlert.showSuccessAlert("Bạn đã xóa sản phẩm thành công!")
                        setTimeout(function () {
                            App.SweetAlert.showSuccessAlert("Bạn sẽ trở về danh sách sản phẩm sau 3s")
                            window.location.href = "/product-dashboard";
                        }, 3000);
                    }).fail(()=>{
                        App.SweetAlert.showErrorAlert("Bạn đã xóa sản phẩm Thất bại!")
                    })
                }
            })
        })
    }

    $(function(){
        page.commands.handleDeleteProduct();
    })
</script>
</html>